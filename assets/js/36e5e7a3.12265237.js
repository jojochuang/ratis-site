"use strict";(self.webpackChunkratis_tmp=self.webpackChunkratis_tmp||[]).push([[3102],{1123:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>p});const t=JSON.parse('{"id":"contributors/deploying","title":"Deploying Releases/Snapshots","description":"This document describes how to deploy releases and snapshots specifically for Apache Ratis. For general information about Publishing Maven Artifacts at Apache, see http://www.apache.org/dev/publishing-maven-artifacts.html","source":"@site/docs/contributors/deploying.md","sourceDirName":"contributors","slug":"/contributors/deploying","permalink":"/ratis-site/docs/contributors/deploying","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ratis-site/edit/main/docs/contributors/deploying.md","tags":[],"version":"current","frontMatter":{"title":"Deploying Releases/Snapshots"},"sidebar":"tutorialSidebar","previous":{"title":"Building","permalink":"/ratis-site/docs/contributors/building"}}');var r=n(4848),i=n(8453);const o={title:"Deploying Releases/Snapshots"},a=void 0,l={},p=[{value:"Prerequisite",id:"prerequisite",level:2},{value:"Environment Setup",id:"environment-setup",level:2},{value:"How to Deploy",id:"how-to-deploy",level:2},{value:"Steps for Deploying a Snapshot",id:"steps-for-deploying-a-snapshot",level:3}];function c(e){const s={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.p,{children:["This document describes how to deploy releases and snapshots specifically for Apache Ratis. For general information about Publishing Maven Artifacts at Apache, see ",(0,r.jsx)(s.a,{href:"http://www.apache.org/dev/publishing-maven-artifacts.html",children:"http://www.apache.org/dev/publishing-maven-artifacts.html"})]}),"\n",(0,r.jsx)(s.h2,{id:"prerequisite",children:"Prerequisite"}),"\n",(0,r.jsxs)(s.p,{children:["It requires ",(0,r.jsx)(s.em,{children:"committer access"})," in order to deploy releases and snapshots."]}),"\n",(0,r.jsx)(s.h2,{id:"environment-setup",children:"Environment Setup"}),"\n",(0,r.jsxs)(s.p,{children:["To publish, use the following ",(0,r.jsx)(s.code,{children:"settings.xml"})," file (placed in ",(0,r.jsx)(s.code,{children:"~/.m2/settings.xml"}),"):"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-xml",children:"<settings>\n  <servers>\n    <server>\n      <id>apache.releases.https</id>\n      <username>your-apache-username</username>\n      <password>{your-encrypted-password}</password>\n    </server>\n    <server>\n      <id>apache.snapshots.https</id>\n      <username>your-apache-username</username>\n      <password>{your-encrypted-password}</password>\n    </server>\n  </servers>\n</settings>\n"})}),"\n",(0,r.jsxs)(s.p,{children:["To use encrypted password, see ",(0,r.jsx)(s.a,{href:"http://maven.apache.org/guides/mini/guide-encryption.html",children:"http://maven.apache.org/guides/mini/guide-encryption.html"}),"\nFor OpenPGP setup, see ",(0,r.jsx)(s.a,{href:"http://www.apache.org/dev/openpgp.html",children:"http://www.apache.org/dev/openpgp.html"})]}),"\n",(0,r.jsx)(s.h2,{id:"how-to-deploy",children:"How to Deploy"}),"\n",(0,r.jsx)(s.p,{children:"We use Apache Maven Deploy Plugin to deploy artifacts."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"mvn deploy\n# or\nmvn -s /my/path/settings.xml deploy\n"})}),"\n",(0,r.jsx)(s.p,{children:"We also use release profile for building the release."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"mvn install -Prelease -Papache-release\n"})}),"\n",(0,r.jsx)(s.h3,{id:"steps-for-deploying-a-snapshot",children:"Steps for Deploying a Snapshot"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Test the artifacts locally."})}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Clean, shade and compile everything."}),"\n",(0,r.jsx)(s.li,{children:"Run all tests."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Set snapshot version locally."})}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Get the last commit id:","\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"git log --abbrev-commit --abbrev=7 --pretty=oneline | head -1"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"2.  Set the versions of local artifacts:\n```bash\nmvn versions:set -DnewVersion=--SNAPSHOT\n"})}),"\n",(0,r.jsxs)(s.ol,{start:"3",children:["\n",(0,r.jsxs)(s.li,{children:["If everything works fine, run the following command to publish artifacts to Apache repository:","\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"mvn deploy -DskipTests -DskipShade"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"\n4.  Verify the snapshot artifacts published in [https://repository.apache.org/content/groups/snapshots/org/apache/ratis/](https://repository.apache.org/content/groups/snapshots/org/apache/ratis/)\n\nFinally, you may delete the `pom.xml.versionsBackup` files by:\n\n```bash\nfind . -name pom.xml.versionsBackup | xargs rm\n"})})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>a});var t=n(6540);const r={},i=t.createContext(r);function o(e){const s=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);