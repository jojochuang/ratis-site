"use strict";(self.webpackChunkratis_tmp=self.webpackChunkratis_tmp||[]).push([[390],{1680:e=>{e.exports=JSON.parse('{"permalink":"/ratis-site/blog/2023/11/21/3.0.0","editUrl":"https://github.com/apache/ratis-site/edit/main/blog/2023-11-21-3.0.0.md","source":"@site/blog/2023-11-21-3.0.0.md","title":"Release 3.0.0 is available","description":"\x3c!---","date":"2023-11-21T00:00:00.000Z","tags":[],"readingTime":5.41,"hasTruncateMarker":true,"authors":[],"frontMatter":{"title":"Release 3.0.0 is available"},"unlisted":false,"prevItem":{"title":"Release 3.0.1 is available","permalink":"/ratis-site/blog/2024/01/09/3.0.1"},"nextItem":{"title":"Release 2.5.1 is available","permalink":"/ratis-site/blog/2023/05/05/2.5.1"}}')},5404:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>a});var r=i(6672);const t={},l=r.createContext(t);function s(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(l.Provider,{value:n},e.children)}},9677:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>o});var r=i(1680),t=i(3420),l=i(5404);const s={title:"Release 3.0.0 is available"},a="Incompatible Changes",d={authorsImageUrls:[]},o=[{value:"Streaming &amp; Netty",id:"streaming--netty",level:2},{value:"Read Index",id:"read-index",level:2},{value:"RaftServer",id:"raftserver",level:2},{value:"AppendEntries &amp; GrpcLogAppender",id:"appendentries--grpclogappender",level:2},{value:"RaftLog &amp; RaftLog Cache",id:"raftlog--raftlog-cache",level:2},{value:"Common Utilities",id:"common-utilities",level:2}];function c(e){const n={a:"a",h1:"h1",h2:"h2",li:"li",p:"p",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://ratis.apache.org/downloads.html",children:"Download"})}),"\n",(0,t.jsx)(n.p,{children:"This is a major new version that contains 100 improvements and bug fixes. It introduces new features like pluggable metrics and lease read, etc.\nSee the changes between 2.5.1 and 3.0.0 releases as below:"}),"\n",(0,t.jsx)(n.p,{children:"Change list of ratis 3.0.0\nIn total, there are roughly 100 commits diffing from 2.5.1"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RaftStorage Auto-Format"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RATIS-1677. Do not auto format RaftStorage in RECOVER. (#718)"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RATIS-1694. Fix the compatibility issue of RATIS-1677. (#731)"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RATIS-1871. Auto format RaftStorage when there is only one\ndirectory configured. (#903)"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Pluggable Ratis-Metrics (RATIS-1688)"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RATIS-1689. Remove the use of the thirdparty Gauge. (#728)"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RATIS-1692. Remove the use of the thirdparty Counter. (#732)"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RATIS-1693. Remove the use of the thirdparty Timer. (#734)"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RATIS-1703. Move MetricsReporting and JvmMetrics to impl. (#741)"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:'RATIS-1704. Fix SuppressWarnings("VisibilityModifier") in\nRatisMetrics. (#742)'}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RATIS-1710. Refactor metrics api and implementation to separated\nmodules. (#749)"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RATIS-1712. Add a dropwizard 3 implementation of ratis-metrics-api. (#751)"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RATIS-1391. Update library dropwizard.metrics version to 4.x (#632)"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RATIS-1601. Use the shaded dropwizard metrics and remove the\ndependency (#671)"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Streaming Protocol Change"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"RATIS-1569. Move the asyncRpcApi.sendForward(..) call to the\nclient side. (#635)"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"new-features",children:"New Features"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Leader Lease (RATIS-1864)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1865. Add leader lease bound ratio configuration (#897)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1866. Maintain leader lease after AppendEntries (#898)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1894. Implement ReadOnly based on leader lease (#925)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1882. Support read-after-write consistency (#913)"}),"\n",(0,t.jsx)(n.li,{children:"StateMachine API"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1874. Add notifyLeaderReady function in IStateMachine (#906)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1897. Make TransactionContext available in DataApi.write(..). (#930)"}),"\n",(0,t.jsx)(n.li,{children:"New Configuration Properties"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1862. Add the parameter whether to take Snapshot when\nstopping to adapt to different services (#896)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1930. Add a conf for enable/disable majority-add. (#961)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1918. Introduces parameters that separately control the\nshutdown of RaftServerProxy by JVMPauseMonitor. (#950)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1636. Support re-config ratis properties (#800)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1860. Add ratis-shell cmd to generate a new raft-meta.conf. (#901)"}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"improvements--bug-fixes",children:"Improvements & Bug Fixes"}),"\n",(0,t.jsx)(n.h2,{id:"streaming--netty",children:"Streaming & Netty"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"RATIS-1550. Rewrite stream client reply queue. (#740)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1847. Stream has memory leak. (#884)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1850. When the stream server side receives a disconnection,\nmemory is cleared (#887)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1853. When the stream server channelInactive, all requests in\nthe channel. (#889)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1880. Optimize Stream client&server side channel pipeline Create (#910)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1898. Netty should use EpollEventLoopGroup by default (#931)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1899. Use EpollEventLoopGroup for Netty Proxies (#932)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1913. Assert that the primary peers in DataStreamClient and\nRoutingTable are equal (#945)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1921. Shared worker group in WorkerGroupGetter should be closed. (#955)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1923. Netty: atomic operations require side-effect-free\nfunctions. (#956)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"read-index",children:"Read Index"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"RATIS-1856. Notify apply index change of all RaftLog entries (#893)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1895. IllegalStateException: Failed to updateIncreasingly for\nnextIndex. (#926)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1861. NullPointerException in readAsync when Ratis leader is\nchanging (#895)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1888. Handle exception of readIndexAsync in gRPC readIndex impl (#920)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1927. Use double check to eliminate data race in ReadRequests. (#958)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"raftserver",children:"RaftServer"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"RATIS-1924. Increase the default of raft.server.log.segment.size.max. (#957)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1892. Unify the lifetime of the RaftServerProxy thread pool (#923)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1889. NoSuchMethodError:\nRaftServerMetricsImpl.addNumPendingRequestsGauge #922 (#922)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-761. Handle writeStateMachineData failure in leader. (#927)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1902. The snapshot index is set incorrectly in\nInstallSnapshotReplyProto. (#933)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1912. Fix infinity election when perform membership change. (#954)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1858. Follower keeps logging first election timeout. (#894)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"appendentries--grpclogappender",children:"AppendEntries & GrpcLogAppender"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"RATIS-1804. Change the default number of outstanding append entries. (#838)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1883. Next Index should be always larger than Match Index in\nGrpcLogAppender (#914)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1886. AppendLog sleep fixed time cause significant drop in\nwrite throughput. (#929)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1909. Fix Decreasing Next Index When GrpcLogAppender Reset\nClient. (#939)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1920. NPE in AppendLogResponseHandler. (#952)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1928. Join the LogAppenders when closing the server. (#959)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1705. Fix metrics leak (#744)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"raftlog--raftlog-cache",children:"RaftLog & RaftLog Cache"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"RATIS-1887. Gap between segement log (#919)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1890. SegmentedRaftLogCache#shouldEvict should only iterate\nover closed segments once (#921)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1893. In SegmentedRaftLogCache, start a daemon thread to\ncheckAndEvictCache. (#924)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1884. Fix retry cache warning condition (#915)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-872. Invalidate replied calls in retry cache. (#942)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1916. OrderAsync does not call handReply. (#948)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"common-utilities",children:"Common Utilities"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"RATIS-1932. Create zero-copy Marshaller. (#962)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1910. Deduplicate RaftGroupId and ClientId. (#940)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1867. To uniformly manage the timeout parameters for detecting\ngc. (#899)"}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"code-cleanup--refactoring",children:"Code Cleanup & Refactoring"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"RATIS-1870. Refactor hasMajority code during configuration changes. (#902)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1848. Simplify PeerMap inheritance (#885)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1849. Remove unused getRaftClient (#886)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1854. Remove useless error logs when closing the ratisclient\nwriting thread (#890)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1904. Refactor RaftServerImpl.submitClientRequestAsync(..). (#935)"}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"code-improvement",children:"Code Improvement"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"RATIS-1852. Fix trivial SonarLint complains (#888)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1855. Fix some sonar code smell and bugs in ratis-server (#892)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1903. Fix parameter number warning in RaftClientRequest. (#934)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1905. Fix some sonar lint complains (#936)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1915. Do not use FileInputStream/FileOutputStream in\nratis-common. (#947)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1917. Print Epoll.unavailabilityCause() only once. (#949)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1919. Fix some sonar code smell and bugs in\nratis-client/common/grpc (#951)"}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"documentations--examples",children:"Documentations & Examples"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:'RATIS-1842. Fix typo of "configuraions.md" name in ratis-docs project (#880)'}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1843. Add existing markdown documents to site.xml in the\nratis-docs project (#881)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1901. Update Counter example to benchmark performance. (#953)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1908. Keep configurations doc updated (#938)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1911. Add MembershipManager example. (#941)"}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"tests",children:"Tests"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"RATIS-1828. Enable TestServerRestartWithNetty (#869)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1830. Intermittent failure in TestRetryPolicy (#871)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1832. Intermittent failure in TestStreamObserverWithTimeout (#873)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1833. Intermittent failure in\nTestRaftStateMachineExceptionWithSimulatedRpc (#874)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1599. Fix test failure from RATIS-1569. (#659)"}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"build--maven",children:"Build & Maven"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"RATIS-1829. Support magic links to PR and JIRA in IDEA (#870)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1878. checkstyle fails with UnsupportedClassVersionError. (#909)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1906. Bump copyright year to 2023 (#937)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1914. Bouncy Castle For Java LDAP injection vulnerability. (#944)"}),"\n",(0,t.jsx)(n.li,{children:"RATIS-1929. Bump ratis-thirdparty version to 1.0.5 (#960)"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["It has been tested with ",(0,t.jsx)(n.a,{href:"https://ozone.apache.org",children:"Apache Ozone"}),", ",(0,t.jsx)(n.a,{href:"https://iotdb.apache.org",children:"Apache IoTDB"}),", ",(0,t.jsx)(n.a,{href:"https://www.alluxio.io/",children:"Alluxio"}),"\nwhere Apache Ratis is used to replicate raw data and to provide high availability."]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);