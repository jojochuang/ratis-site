"use strict";(self.webpackChunkratis_tmp=self.webpackChunkratis_tmp||[]).push([[5949],{1924:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"features/observability","title":"Observability","description":"Ratis provides a comprehensive metrics system to monitor the health and performance of your cluster. This tutorial explains how to expose and consume these metrics.","source":"@site/docs/features/observability.md","sourceDirName":"features","slug":"/features/observability","permalink":"/ratis-site/docs/features/observability","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ratis-site/edit/main/docs/features/observability.md","tags":[],"version":"current","frontMatter":{"title":"Observability"},"sidebar":"tutorialSidebar","previous":{"title":"Pre-vote","permalink":"/ratis-site/docs/features/pre-vote"},"next":{"title":"Ratis Tools","permalink":"/ratis-site/docs/tools"}}');var n=i(3420),r=i(5404);const o={title:"Observability"},a="Observability in Ratis",c={},l=[{value:"Core Concepts",id:"core-concepts",level:2},{value:"Exposing Metrics",id:"exposing-metrics",level:2},{value:"1. JMX (Java Management Extensions)",id:"1-jmx-java-management-extensions",level:3},{value:"2. Console Reporting",id:"2-console-reporting",level:3},{value:"Available Metrics",id:"available-metrics",level:2}];function d(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"observability-in-ratis",children:"Observability in Ratis"})}),"\n",(0,n.jsx)(t.p,{children:"Ratis provides a comprehensive metrics system to monitor the health and performance of your cluster. This tutorial explains how to expose and consume these metrics."}),"\n",(0,n.jsx)(t.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,n.jsx)(t.p,{children:"Ratis uses a pluggable metrics system with the following key components:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"ratis-metrics-api"})}),": Defines the core metrics APIs."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"ratis-metrics-default"})}),": The default implementation, which uses the Dropwizard Metrics library."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"MetricRegistries"})}),": The main entry point for creating and accessing metric registries."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.code,{children:"RatisMetricRegistry"})}),":  Where metrics are registered and stored."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"exposing-metrics",children:"Exposing Metrics"}),"\n",(0,n.jsxs)(t.p,{children:["By default, Ratis exposes metrics via JMX (Java Management Extensions) without requiring any additional configuration. This is because the ",(0,n.jsx)(t.code,{children:"ratis-metrics-default"})," module is included as a dependency in ",(0,n.jsx)(t.code,{children:"ratis-server"}),", which automatically enables JMX reporting."]}),"\n",(0,n.jsx)(t.h3,{id:"1-jmx-java-management-extensions",children:"1. JMX (Java Management Extensions)"}),"\n",(0,n.jsx)(t.p,{children:"You can use any JMX client, such as JConsole or VisualVM, to connect to your Ratis server and view the available metrics. This is the recommended way to monitor a Ratis cluster in a production environment."}),"\n",(0,n.jsx)(t.h3,{id:"2-console-reporting",children:"2. Console Reporting"}),"\n",(0,n.jsx)(t.p,{children:"For quick debugging and monitoring, Ratis can be configured to periodically print metrics to the console."}),"\n",(0,n.jsx)(t.p,{children:"To enable console reporting for JVM metrics, you can add the following code to your application's startup sequence:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-java",children:"import org.apache.ratis.metrics.impl.JvmMetrics;\nimport org.apache.ratis.util.TimeDuration;\nimport java.util.concurrent.TimeUnit;\n\n// ...\n\n// Initialize JVM metrics and report to the console every 10 seconds\nJvmMetrics.initJvmMetrics(TimeDuration.valueOf(10, TimeUnit.SECONDS));\n"})}),"\n",(0,n.jsx)(t.p,{children:"This will print a summary of JVM-related metrics to the console at the specified interval."}),"\n",(0,n.jsx)(t.h2,{id:"available-metrics",children:"Available Metrics"}),"\n",(0,n.jsx)(t.p,{children:"Ratis exposes a wide range of metrics, including:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Server Metrics"}),":  Metrics related to the Raft server, such as the number of pending requests, commit index, and more."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Client Metrics"}),": Metrics related to the Raft client, such as request latency and retry counts."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Log Metrics"}),": Metrics related to the Raft log, such as the number of log entries and the size of the log."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Leader Election Metrics"}),": Metrics related to the leader election process."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"gRPC and Netty Metrics"}),": Metrics specific to the RPC and data stream layers."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"You can explore the full list of available metrics by connecting to your Ratis server with a JMX client."})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},5404:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>a});var s=i(6672);const n={},r=s.createContext(n);function o(e){const t=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);