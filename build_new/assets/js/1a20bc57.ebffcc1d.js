"use strict";(self.webpackChunkratis_tmp=self.webpackChunkratis_tmp||[]).push([[9114],{6768:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"cli","title":"Ratis-shell CLI","description":"Ratis-shell is the command line interface of Ratis.","source":"@site/docs/cli.md","sourceDirName":".","slug":"/cli","permalink":"/ratis-site/docs/cli","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ratis-site/edit/main/docs/cli.md","tags":[],"version":"current","frontMatter":{"title":"Ratis-shell CLI"},"sidebar":"tutorialSidebar","previous":{"title":"State Machine Snapshot","permalink":"/ratis-site/docs/concepts/state-machine-snapshot"},"next":{"title":"Read-After-Write Consistency Support","permalink":"/ratis-site/docs/features/read-after-write"}}');var n=r(4848),l=r(8453);const i={title:"Ratis-shell CLI"},a="Ratis-shell",o={},c=[{value:"Availability",id:"availability",level:2},{value:"Setting up the ratis-shell",id:"setting-up-the-ratis-shell",level:2},{value:"Setting up from a source tarball",id:"setting-up-from-a-source-tarball",level:3},{value:"Setting up from a binary tarball",id:"setting-up-from-a-binary-tarball",level:3},{value:"generic options",id:"generic-options",level:2},{value:"election",id:"election",level:2},{value:"election transfer",id:"election-transfer",level:3},{value:"election stepDown",id:"election-stepdown",level:3},{value:"election pause",id:"election-pause",level:3},{value:"election resume",id:"election-resume",level:3},{value:"group",id:"group",level:2},{value:"group info",id:"group-info",level:3},{value:"group list",id:"group-list",level:3},{value:"peer",id:"peer",level:2},{value:"peer add",id:"peer-add",level:3},{value:"peer remove",id:"peer-remove",level:3},{value:"peer setPriority",id:"peer-setpriority",level:3},{value:"snapshot",id:"snapshot",level:2},{value:"snapshot create",id:"snapshot-create",level:3},{value:"local",id:"local",level:2},{value:"local raftMetaConf",id:"local-raftmetaconf",level:3}];function d(e){const s={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,l.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"ratis-shell",children:"Ratis-shell"})}),"\n",(0,n.jsx)(s.p,{children:"Ratis-shell is the command line interface of Ratis."}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Note"}),":\nRatis-shell is currently only ",(0,n.jsx)(s.strong,{children:"experimental"}),".\nThe compatibility story is not considered for the time being."]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"availability",children:"Availability"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{style:{textAlign:"center"},children:"Version"}),(0,n.jsx)(s.th,{style:{textAlign:"center"},children:"Available in src tarball?"}),(0,n.jsx)(s.th,{style:{textAlign:"center"},children:"Available in bin tarball?"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"< 2.3.0"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"No"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"No"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"2.3.0"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"No"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"> 2.3.0"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"Yes"})]})]})]}),"\n",(0,n.jsx)(s.h2,{id:"setting-up-the-ratis-shell",children:"Setting up the ratis-shell"}),"\n",(0,n.jsx)(s.h3,{id:"setting-up-from-a-source-tarball",children:"Setting up from a source tarball"}),"\n",(0,n.jsxs)(s.p,{children:["Download the Ratis source tarball from ",(0,n.jsx)(s.a,{href:"https://ratis.apache.org/downloads.html",children:"https://ratis.apache.org/downloads.html"})," . Note that ratis-shell is available starting from version 2.3.0. Extract the source tarball to a destination directory `` and then build the ratis-shell tarball."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"$ tar -C <dest-dir> -zxvf apache-ratis-<version>-src.tar.gz\n$ cd <dest-dir>/apache-ratis-<version>-src\n$ mvn -DskipTests -Prelease -Papache-release clean package assembly:single\n"})}),"\n",(0,n.jsx)(s.p,{children:"Extract the ratis-shell tarball."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"$ mkdir <dest-dir>/ratis-shell\n$ tar -C <dest-dir>/ratis-shell -xzf ratis-assembly/target/apache-ratis-<version>-shell.tar.gz --strip-component 1\n"})}),"\n",(0,n.jsx)(s.h3,{id:"setting-up-from-a-binary-tarball",children:"Setting up from a binary tarball"}),"\n",(0,n.jsxs)(s.p,{children:["Download the Ratis bin tarball from ",(0,n.jsx)(s.a,{href:"https://ratis.apache.org/downloads.html",children:"https://ratis.apache.org/downloads.html"})," . Note that the bin tarball of Ratis version 2.3.0 or earlier does not contain ratis-shell. The bin tarball of later versions will contain ratis-shell. Extract the bin tarball to a destination directory ``"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"$ tar -C <dest-dir> -zxvf apache-ratis-<version>-bin.tar.gz apache-ratis-<version>/ratis-shell\n$ cd <dest-dir>\n$ mv apache-ratis-<version>/ratis-shell .\n$ rmdir apache-ratis-<version>/\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Export the ",(0,n.jsx)(s.code,{children:"RATIS_SHELL_HOME"})," environment variable and add the bin directory to the ",(0,n.jsx)(s.code,{children:"$PATH"}),"."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"$ export RATIS_SHELL_HOME=<dest-dir>/ratis-shell\n$ export PATH=${RATIS_SHELL_HOME}/bin:$PATH\n"})}),"\n",(0,n.jsx)(s.p,{children:"The following command can be invoked in order to get the basic usage:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ ratis sh\nUsage: ratis sh [generic options] [election [transfer] [stepDown] [pause] [resume]] [group [info] [list]] [peer [add] [remove] [setPriority]] [snapshot [create]] [local [raftMetaConf]]\n"})}),"\n",(0,n.jsx)(s.h2,{id:"generic-options",children:"generic options"}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"generic options"})," supports the following content: ",(0,n.jsx)(s.code,{children:"-D*"}),", ",(0,n.jsx)(s.code,{children:"-X*"}),", ",(0,n.jsx)(s.code,{children:"-agentlib*"}),", ",(0,n.jsx)(s.code,{children:"-javaagent*"})," The ",(0,n.jsx)(s.code,{children:"-D*"})," can pass values for a given ratis property to ratis-shell client RaftProperties."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ ratis sh -D ...\n"})}),"\n",(0,n.jsx)(s.h2,{id:"election",children:"election"}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"election"})," command manages leader election. It has the following subcommands: ",(0,n.jsx)(s.code,{children:"transfer"}),", ",(0,n.jsx)(s.code,{children:"stepDown"}),", ",(0,n.jsx)(s.code,{children:"pause"}),", ",(0,n.jsx)(s.code,{children:"resume"})]}),"\n",(0,n.jsx)(s.h3,{id:"election-transfer",children:"election transfer"}),"\n",(0,n.jsx)(s.p,{children:"Transfer a group leader to the specified server."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ ratis sh election transfer -peers <PEER_ID:PEER_ADDRESS,...> -address <PEER_ADDRESS> [-groupid <GROUP_ID>]\n"})}),"\n",(0,n.jsx)(s.h3,{id:"election-stepdown",children:"election stepDown"}),"\n",(0,n.jsx)(s.p,{children:"Make a group leader of the given group step down its leadership."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ ratis sh election stepDown -peers <PEER_ID:PEER_ADDRESS,...> [-groupid <GROUP_ID>]\n"})}),"\n",(0,n.jsx)(s.h3,{id:"election-pause",children:"election pause"}),"\n",(0,n.jsx)(s.p,{children:"Pause leader election at the specified server. Then, the specified server would not start a leader election."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ ratis sh election pause -peers <PEER_ID:PEER_ADDRESS,...> -address <PEER_ADDRESS> [-groupid <GROUP_ID>]\n"})}),"\n",(0,n.jsx)(s.h3,{id:"election-resume",children:"election resume"}),"\n",(0,n.jsx)(s.p,{children:"Resume leader election at the specified server."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ ratis sh election resume -peers <PEER_ID:PEER_ADDRESS,...> -address <PEER_ADDRESS> [-groupid <GROUP_ID>]\n"})}),"\n",(0,n.jsx)(s.h2,{id:"group",children:"group"}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"group"})," command manages ratis groups. It has the following subcommands: ",(0,n.jsx)(s.code,{children:"info"}),", ",(0,n.jsx)(s.code,{children:"list"})]}),"\n",(0,n.jsx)(s.h3,{id:"group-info",children:"group info"}),"\n",(0,n.jsx)(s.p,{children:"Display the information of a specific raft group."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ ratis sh group info -peers <PEER_ID:PEER_ADDRESS,...> [-groupid <GROUP_ID>]\n"})}),"\n",(0,n.jsx)(s.h3,{id:"group-list",children:"group list"}),"\n",(0,n.jsx)(s.p,{children:"Display the group information of a specific raft server"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ ratis sh group list -peers <PEER_ID:PEER_ADDRESS,...> [-groupid <GROUP_ID>] <[-serverAddress <SERVER_ADDRESS>]|[-peerId <PEER_ID>]>\n"})}),"\n",(0,n.jsx)(s.h2,{id:"peer",children:"peer"}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"peer"})," command manages ratis cluster peers. It has the following subcommands: ",(0,n.jsx)(s.code,{children:"add"}),", ",(0,n.jsx)(s.code,{children:"remove"}),", ",(0,n.jsx)(s.code,{children:"setPriority"})]}),"\n",(0,n.jsx)(s.h3,{id:"peer-add",children:"peer add"}),"\n",(0,n.jsx)(s.p,{children:"Add peers to a ratis group."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ ratis sh peer add -peers <PEER_ID:PEER_ADDRESS,...> [-groupid <GROUP_ID>] -address <PEER_ADDRESS>\n"})}),"\n",(0,n.jsx)(s.h3,{id:"peer-remove",children:"peer remove"}),"\n",(0,n.jsx)(s.p,{children:"Remove peers to from a ratis group."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ ratis sh peer remove -peers <PEER_ID:PEER_ADDRESS,...> [-groupid <GROUP_ID>] -address <PEER_ADDRESS>\n"})}),"\n",(0,n.jsx)(s.h3,{id:"peer-setpriority",children:"peer setPriority"}),"\n",(0,n.jsx)(s.p,{children:"Set priority to ratis peers. The priority of ratis peer can affect the leader election, the server with the highest priority will eventually become the leader of the cluster."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ ratis sh peer setPriority -peers <PEER_ID:PEER_ADDRESS,...> [-groupid <GROUP_ID>] -addressPriority <PEER_ID:PRIORITY,...>\n"})}),"\n",(0,n.jsx)(s.h2,{id:"snapshot",children:"snapshot"}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"snapshot"})," command manages ratis snapshot. It has the following subcommands: ",(0,n.jsx)(s.code,{children:"create"})]}),"\n",(0,n.jsx)(s.h3,{id:"snapshot-create",children:"snapshot create"}),"\n",(0,n.jsx)(s.p,{children:"Trigger the specified server take snapshot."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ ratis sh snapshot create -peers <PEER_ID:PEER_ADDRESS,...> -peerId <PEER_ID> [-groupid <GROUP_ID>]\n"})}),"\n",(0,n.jsx)(s.h2,{id:"local",children:"local"}),"\n",(0,n.jsxs)(s.p,{children:["The ",(0,n.jsx)(s.code,{children:"local"})," command is used to process local operation, which no need to connect to ratis server. It has the following subcommands: ",(0,n.jsx)(s.code,{children:"raftMetaConf"})]}),"\n",(0,n.jsx)(s.h3,{id:"local-raftmetaconf",children:"local raftMetaConf"}),"\n",(0,n.jsx)(s.p,{children:"Generate a new raft-meta.conf file based on original raft-meta.conf and new peers, which is used to move a raft node to a new node."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"$ ratis sh local raftMetaConf -peers <[P0_ID|]P0_HOST:P0_PORT,[P1_ID|]P1_HOST:P1_PORT,[P2_ID|]P2_HOST:P2_PORT> -path <PATH>\n"})})]})}function h(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,s,r)=>{r.d(s,{R:()=>i,x:()=>a});var t=r(6540);const n={},l=t.createContext(n);function i(e){const s=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),t.createElement(l.Provider,{value:s},e.children)}}}]);